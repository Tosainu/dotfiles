#!/usr/bin/env ruby

require 'optparse'
require 'webrick'

options = {}
OptionParser.new do |opts|
  opts.banner = 'Usage: serve [options]'

  opts.on '-p', '--port PORT', Integer, 'listening port number' do |p|
    options[:port] = p
  end

  opts.on '-r', '--root ROOT', String, 'document root' do |r|
    options[:root] = File.expand_path r
  end
end.parse!

server = WEBrick::HTTPServer.new(
  :DocumentRoot => options[:root] || Dir.pwd,
  :Port         => options[:port] || 3000
)

trap('INT') {server.shutdown}

server.start
